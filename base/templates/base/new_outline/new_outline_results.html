{% extends "base/new_outline/new_outline.html" %}
{% block content %}
{% load i18n %}
{% load crispy_forms_tags %}
<div class="alert alert-primary mb-2 mt-0" role="alert">
  {% trans 'New, currently supported by the website, legal (soon on the forum) version of send script' %}<a href="{% url 'base:documentation' %}#send-script">
    {% trans 'here' %}.
  </a>
</div>

 
<div class="table-responsive">
<div class="mt-2 mb-5" id='leftscroll'>
    <ul class="nav nav-pills mb-3 mt-1" id="pills-tab" role="tablist">
        <li class="nav-item navitem100">
            <a class="nav-link active ocean-tab-left" id="pills-home-tab" data-toggle="pill" href="#pills-outline" role="tab" aria-controls="pills-home" aria-selected="true">{% trans 'Outline results' %}</a>
        </li>
        <li class="nav-item navitem100">
            <a class="nav-link ocean-tab-mid" id="pills-sum-up" data-toggle="pill" href="#pills-outline-sum-up" role="tab" aria-controls="pills-sum-up" aria-selected="false">{% trans 'Sum Up' %}</a>
        </li>

        <li class="nav-item navitem100">
            <a class="nav-link ocean-tab-mid" id="pills-contact-tab" data-toggle="pill" href="#pills-outline-copy1" role="tab" aria-controls="pills-contact" aria-selected="false">{% trans 'Copy Outline urls' %}</a>
        </li>



        <li class="nav-item navitem100">
            <a class="nav-link ocean-tab-mid" id="pills-contact-tab" data-toggle="pill" href="#pills-outline-copy2" role="tab" aria-controls="pills-contact" aria-selected="false">{% trans 'Copy Outline results' %}</a>
        </li>

        <li class="nav-item navitem100">
            <a class="nav-link ocean-tab-mid" id="pills-export" data-toggle="pill" href="#pills-outline-export" role="tab" aria-controls="pills-export" aria-selected="false">{% trans 'Left troops' %}</a>
        </li>

        <li class="nav-item navitem100">
            <a class="nav-link ocean-tab-right" id="pills-contact-tab" data-toggle="pill" href="#pills-deff" role="tab" aria-controls="pills-contact" aria-selected="false">{% trans 'Deff collection' %}</a>
        </li>

    </ul>

    <div class="tab-content" id="pills-tabContent">
        <div class="tab-pane fade show active" id="pills-outline" role="tabpanel" aria-labelledby="pills-home-tab">

            <div class="card">
                <div class="card-header" id="headingTwo">
                  <h5 class="mb-0">

                    <button class="btn btn-link collapsed py-1 text-left card-header-button" type="button" data-toggle="collapse" data-target="#collapseOne" aria-expanded="true" aria-controls="collapseOne">
                        {% if form1.errors %}
                        <span><svg width="1.5em" height="1.5em" viewBox="0 0 16 16" class="bi bi-exclamation-diamond" fill="red" xmlns="http://www.w3.org/2000/svg">
                            <path fill-rule="evenodd" d="M6.95.435c.58-.58 1.52-.58 2.1 0l6.515 6.516c.58.58.58 1.519 0 2.098L9.05 15.565c-.58.58-1.519.58-2.098 0L.435 9.05a1.482 1.482 0 0 1 0-2.098L6.95.435zm1.4.7a.495.495 0 0 0-.7 0L1.134 7.65a.495.495 0 0 0 0 .7l6.516 6.516a.495.495 0 0 0 .7 0l6.516-6.516a.495.495 0 0 0 0-.7L8.35 1.134z"/>
                            <path d="M7.002 11a1 1 0 1 1 2 0 1 1 0 0 1-2 0zM7.1 4.995a.905.905 0 1 1 1.8 0l-.35 3.507a.552.552 0 0 1-1.1 0L7.1 4.995z"/>
                          </svg></span>
                        {% endif %}
                      {% trans 'Set title, text and show hidden value' %}
                    </button>

                  </h5>

                </div>
                <div id="collapseOne" class="collapse" aria-labelledby="headingOne" data-parent="#accordionExample">
                  <div class="card-body">
                    <form method="POST">
                        <input type="hidden" name="form1" value="">
                        {% csrf_token %}
                        {{form1|crispy}}
                        <button onclick="this.disabled=true;this.form.submit();" class="btn btn-ocean">{% trans 'Save' %}</button>
                    </form>
                    

                  </div>
                </div>
              </div>
            <div class="card">
                <div class="card-header" id="headingTwo">
                  <h5 class="mb-0">

                    <button class="btn btn-link collapsed text-left card-header-button" type="button" data-toggle="collapse" data-target="#collapseTwo" aria-expanded="true" aria-controls="collapseTwo">
                      {% trans 'Removed links' %}
                    </button>

                  </h5>

                </div>
                <div id="collapseTwo" class="collapse" aria-labelledby="headingTwo" data-parent="#accordionExample">
                  <div class="card-body">
                    <table class="table table-bordered">
                        <thead style="background-color: teal;">
        
                            <tr style="color: white;">
                                <th scope="col" style="border:1px solid teal">{% trans 'Created' %}</th>
                                <th scope="col" style="border:1px solid teal">{% trans 'Player' %}</th>
                                <th scope="col" style="border:1px solid teal">{% trans 'Link to member Page' %}</th>
                                <th scope="col" style="border:1px solid teal">{% trans 'Show Hidden' %}</th>
                                <th scope="col" style="border:1px solid teal">{% trans 'Send message' %}</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for item in removed_overviews %}
        
                            <tr>
                                <th scope="row">{{ item.created }}</th>
                                <th>{{item.player}}</th>
                                <th><a target="_blank" href="{{ request.scheme }}://{{ request.get_host }}{{item.get_absolute_url}}">{% trans 'Go to member Page' %}</a>
                                </th>
                                <th><a href="{% url 'base:planer_overview_hide' instance.id item.token %}">{{item.show_hidden}}</a></th>
                                <th><a class="send" target="_blank" href="{{name_prefix}}/game.php?screen=mail&mode=new#to={{ item.player }}&subject={{instance.title_message}}&message=[b]{{item.player}}[/b]%0A[url]{{ request.scheme }}://{{ request.get_host }}{{item.get_absolute_url}}[/url]%0A%0A{{instance.text_message}}">{% trans 'Send' %}</a>
                                </th>

                            </tr>
                            <script>
                                $('.send').click(function() {
                                    $(this).text("{% trans 'Sent!' %}");})
                            </script>
                            {% endfor %}
                        </tbody>
                    </table>
                    

                  </div>
                </div>
              </div>











            <div>
            <table class="table table-bordered">
                <thead style="background-color: teal;">

                    <tr style="color: white;">
                        <th scope="col" style="border:1px solid teal">#</th>
                        <th scope="col" style="border:1px solid teal">{% trans 'Player' %}</th>
                        <th scope="col" style="border:1px solid teal">{% trans 'Link to member Page' %}</th>
                        <th scope="col" style="border:1px solid teal">{% trans 'Show Hidden' %}</th>
                        <th scope="col" style="border:1px solid teal">{% trans 'Send message' %}</th>
                    </tr>
                </thead>
                <tbody>
                    {% for item in overviews %}

                    <tr>
                        <th scope="row">{{ forloop.counter }}</th>
                        <th>{{item.player}}</th>
                        <th><a target="_blank" href="{{ request.scheme }}://{{ request.get_host }}{{item.get_absolute_url}}">{% trans 'Go to member Page' %}</a>
                        </th>
                        <th><a href="{% url 'base:planer_overview_hide' instance.id item.token %}">{{item.show_hidden}}</a></th>
                        <th><a class="send" target="_blank" href="{{name_prefix}}/game.php?screen=mail&mode=new#to={{ item.player }}&subject={{instance.title_message}}&message=[b]{{item.player}}[/b]%0A[url]{{ request.scheme }}://{{ request.get_host }}{{item.get_absolute_url}}[/url]%0A%0A{{instance.text_message}}">{% trans 'Send' %}</a>
                        </th>
                    </tr>
                    <script>
                        $('.send').click(function() {
                            $(this).text("{% trans 'Sent!' %}");})
                    </script>
                    {% endfor %}
                </tbody>
            </table>
        </div>

        </div>

        <div class="tab-pane fade" id="pills-outline-sum-up" role="tabpanel" aria-labelledby="pills-outline-sum-up">
            <div class="form-group" contenteditable="true">
                <textarea class="form-control" id="zbiorka-wojsko" rows="8">{{instance.result.results_players}}</textarea>
            </div>
            <div class="form-group" contenteditable="true">
                <textarea class="form-control" id="zbiorka-wojsko" rows="24">{{instance.result.results_sum_up}}</textarea>
            </div>
        </div>

        <div class="tab-pane fade" id="pills-outline-copy1" role="tabpanel" aria-labelledby="pills-contact-tab">
            <div class="form-group" contenteditable="true">
                <textarea class="form-control" id="zbiorka-wojsko" rows="26">
{% for item in overviews %}
[b]{{item.player}}[/b]
[url]{{ request.scheme }}://{{ request.get_host }}{{item.get_absolute_url}}[/url]
{% endfor %}
                </textarea>
            </div>
        </div>

        <div class="tab-pane fade" id="pills-outline-copy2" role="tabpanel" aria-labelledby="pills-contact-tab">
            <div class="form-group" contenteditable="true">
                <textarea class="form-control" id="zbiorka-wojsko" rows="26">{{instance.result.results_outline}}</textarea>
            </div>
        </div>

        <div class="tab-pane fade" id="pills-outline-export" role="tabpanel" aria-labelledby="pills-contact-tab">
            <div class="my-3">
              {% trans 'Below you will find the remaining unused player armies. The data is generated AFTER the whole outline is completed, together with the targets, commands, link, etc. If you plan to create a second outline, e.g. for the next day, create a new outline and paste the data below. Although you can use it any other way :) Note that for the sake of simplicity, all offensive troops are listed as axemen, while deff troops are omitted.' %}
            </div>
            <div class="form-group" contenteditable="true">
                <textarea class="form-control" id="zbiorka-wojsko" rows="26">{{instance.result.results_export}}</textarea>
            </div>
        </div>

        <div class="tab-pane fade" id="pills-deff" role="tabpanel" aria-labelledby="pills-contact-tab">
            <div class="form-group" contenteditable="true">
                <textarea class="form-control" id="zbiorka-wojsko" rows="26">{{instance.result.results_get_deff}}</textarea>
            </div>
        </div>

    </div>
</div>
</div>
<script>
    $(window).on("load", function () {
        // weave your magic here.
    
        if (localStorage.getItem("my_app_name_here-quote-scroll") != null) {
          $(window).scrollTop(localStorage.getItem("my_app_name_here-quote-scroll"));
    
    
        };
        if (localStorage.getItem("my_app_name-left-scroll") != null) {
          $('#leftscroll').scrollTop(localStorage.getItem("my_app_name-left-scroll"));
        };
    
    
        $(window).on("scroll", function () {
          localStorage.setItem("my_app_name_here-quote-scroll", $(window).scrollTop());
        });
    
        $('#leftscroll').on("scroll", function () {
          var scroll = $('#leftscroll').scrollTop();
          localStorage.setItem("my_app_name-left-scroll", scroll);
        });
      });
</script>

{% endblock %}